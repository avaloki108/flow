{"treeViewPath":"exploit_deposit_front_running-Assert_CRITICAL_EXPLOIT__Deposit_did_not_increase_balance__frontrun_attack_(CriticalExploits_spec_201_5)","graph_link":"PresolverRule-exploit_deposit_front_running-Assert_CRITICAL_EXPLOIT__Deposit_did_not_increase_balance__frontrun_attack_LPCriticalExploits_spec_201_5RP.html","jumpToDefinition":{"file":"certora/specs/CriticalExploits.spec","start":{"line":201,"col":5},"end":{"line":201,"col":139}},"assertMessage":"\"CRITICAL EXPLOIT: Deposit did not increase balance - front-run attack\"","valueRepresentations":[{"name":"PRETTY","example":"MAX_UINT8"},{"name":"DEC","example":"255"},{"name":"HEX","example":"0xff"}],"callResolution":[],"callResolutionWarnings":[{"caller":{"name":"SablierFlow.withdraw(uint256,address,uint128)","jumpToDefinition":null},"callSite":{"snippet":"comptroller.calculateMinFeeWeiFor({protocol: ISablierComptroller.Protocol.Flow,user: _streams[streamId].sender})","jumpToDefinition":{"file":"src/SablierFlow.sol","start":{"line":968,"col":29},"end":{"line":971,"col":11}}},"summary":"AUTO havoc","comments":[{"callee resolution":"callee contract unresolved; callee sighash resolved"},{"callee resolution hint (1)":"To resolve the call, try '--link SablierFlow:comptroller=[CONTRACT]'"},{"havoc cause":"The Prover could not resolve the callee, thus, havoc'd the call"},{"havoc scope":"a havoc that only havocs the return value"},{"summary application reason":"chosen automatically by the Prover"}],"callee":{"name":"[?].[sighash=0x419d289d]","jumpToDefinition":null},"isInCounterExample":false},{"caller":{"name":"SablierFlow.withdraw(uint256,address,uint128)","jumpToDefinition":null},"callSite":{"snippet":"assembly (\"memory-safe\") {let success := call(gas(), token, 0, add(data, 0x20), mload(data), 0, 0x20)// bubble errorsif iszero(success) {let ptr := mload(0x40)returndatacopy(ptr, 0, returndatasize())revert(ptr, returndatasize())}returnSize := returndatasize()returnValue := mload(0)}","jumpToDefinition":{"file":"node_modules/@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol","start":{"line":176,"col":9},"end":{"line":186,"col":10}}},"summary":"AUTO havoc","comments":[{"callee resolution":"callee contract unresolved; callee sighash resolved"},{"callee resolution hint (1)":"To resolve the call, try '--struct_link SablierFlow:token=[CONTRACT]'"},{"havoc cause":"The Prover could not resolve the callee, thus, havoc'd the call"},{"havoc scope":"a havoc that havocs all contracts except SablierFlow (ce4604a0000000000000000000000025)"},{"summary application reason":"chosen automatically by the Prover"}],"callee":{"name":"[?].[sighash=0xa9059cbb]","jumpToDefinition":null},"isInCounterExample":false},{"caller":{"name":"SablierFlow.deposit(uint256,uint128,address,address)","jumpToDefinition":null},"callSite":{"snippet":"assembly (\"memory-safe\") {let success := call(gas(), token, 0, add(data, 0x20), mload(data), 0, 0x20)// bubble errorsif iszero(success) {let ptr := mload(0x40)returndatacopy(ptr, 0, returndatasize())revert(ptr, returndatasize())}returnSize := returndatasize()returnValue := mload(0)}","jumpToDefinition":{"file":"node_modules/@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol","start":{"line":176,"col":9},"end":{"line":186,"col":10}}},"summary":"AUTO havoc","comments":[{"callee resolution":"callee contract unresolved; callee sighash resolved"},{"callee resolution hint (1)":"To resolve the call, try '--struct_link SablierFlow:token=[SablierFlow]'"},{"havoc cause":"The Prover could not resolve the callee, thus, havoc'd the call"},{"havoc scope":"a havoc that havocs all contracts except SablierFlow (ce4604a0000000000000000000000025)"},{"summary application reason":"chosen automatically by the Prover"}],"callee":{"name":"[?].transferFrom(address,address,uint256)","jumpToDefinition":null},"isInCounterExample":false}]}