[](https://prover.certora.com/)

[](https://www.youtube.com/@certora)[](https://discord.gg/Z9wQfRqZYY)[](https://x.com/certora)[](https://docs.certora.com/)

Copy Link_arrow\_drop\_down_

_chevron\_left_

_keyboard\_arrow\_up__keyboard\_arrow\_down_

executed

_push\_pin_

##### SablierFlow

###### Rules

All Results

_arrow\_drop\_down_

Status_arrow\_drop\_down_Name_arrow\_drop\_down_Progress_arrow\_drop\_down__hourglass\_top__arrow\_drop\_down_

_chevron\_right_

envfreeFuncsStaticCheck

0s

depletionTimeOf(uint256)

0s

totalDebtOf(uint256)

0s

ongoingDebtScaledOf(uint256)

0s

getSnapshotDebtScaled(uint256)

0s

getSender(uint256)

0s

getBalance(uint256)

0s

getRecipient(uint256)

0s

uncoveredDebtOf(uint256)

0s

refundableAmountOf(uint256)

0s

isVoided(uint256)

0s

getSnapshotTime(uint256)

0s

coveredDebtOf(uint256)

0s

_chevron\_right_

exploit\_debt\_overflow\_manipulation

21s

_chevron\_right_

rule\_not\_vacuous

6s

sanity check for rule exploit\_debt\_overf...

6s

Assert\_CRITICAL\_EXPLOIT\_\_Withdrew\_more\_than\_balance\_\_overflow\_detected\_(CriticalExploits\_spec\_75\_9)

4s

Assert\_CRITICAL\_EXPLOIT\_\_Balance\_accounting\_broken\_\_overflow\_detected\_(CriticalExploits\_spec\_77\_9)

4s

Assert\_true\_(CriticalExploits\_spec\_79\_5)

0s

CheckAutoGeneratedAsserts

0s

_chevron\_right_

exploit\_depletion\_time\_calculation

22s

_chevron\_right_

Assert\_CRITICAL\_EXPLOIT\_\_Depletion\_time\_calculation\_allows\_overdraft\_(CriticalExploits\_spec\_251\_9)

20s

CRITICAL EXPLOIT: Depletion time calcula...

20s

Assert\_true\_(CriticalExploits\_spec\_253\_5)

0s

CheckAutoGeneratedAsserts

0s

_chevron\_right_

exploit\_deposit\_front\_running

25s

_chevron\_right_

rule\_not\_vacuous

6s

sanity check for rule exploit\_deposit\_fr...

6s

Assert\_CRITICAL\_EXPLOIT\_\_Deposit\_did\_not\_increase\_balance\_\_frontrun\_attack\_(CriticalExploits\_spec\_201\_5)

5s

CheckAutoGeneratedAsserts

0s

_chevron\_right_

exploit\_pause\_debt\_manipulation

14s

_chevron\_right_

Assert\_CRITICAL\_EXPLOIT\_\_Pause\_decreased\_total\_debt\_\_manipulation\_(CriticalExploits\_spec\_138\_5)

12s

CRITICAL EXPLOIT: Pause decreased total ...

12s

CheckAutoGeneratedAsserts

0s

_chevron\_right_

exploit\_refund\_steals\_covered\_debt

18s

_chevron\_right_

Assert\_CRITICAL\_EXPLOIT\_\_Refund\_stole\_covered\_debt\_from\_recipient\_(CriticalExploits\_spec\_111\_9)

8s

CRITICAL EXPLOIT: Refund stole covered d...

8s

_chevron\_right_

Assert\_CRITICAL\_EXPLOIT\_\_Refund\_extracted\_more\_than\_excess\_balance\_(CriticalExploits\_spec\_114\_9)

15s

CRITICAL EXPLOIT: Refund extracted more ...

15s

Assert\_true\_(CriticalExploits\_spec\_116\_5)

0s

CheckAutoGeneratedAsserts

0s

_chevron\_right_

exploit\_time\_based\_debt\_manipulation

16s

_chevron\_right_

Assert\_CRITICAL\_EXPLOIT\_\_Debt\_decreased\_over\_time\_\_overflow\_detected\_(CriticalExploits\_spec\_223\_5)

14s

CRITICAL EXPLOIT: Debt decreased over ti...

14s

CheckAutoGeneratedAsserts

0s

_chevron\_right_

exploit\_uncovered\_debt\_calculation

21s

_chevron\_right_

Assert\_CRITICAL\_EXPLOIT\_\_Debt\_accounting\_mismatch\_\_manipulation\_possible\_(CriticalExploits\_spec\_157\_5)

11s

CRITICAL EXPLOIT: Debt accounting mismat...

11s

Assert\_CRITICAL\_EXPLOIT\_\_Covered\_debt\_exceeds\_balance\_\_insolvency\_(CriticalExploits\_spec\_160\_5)

9s

_chevron\_right_

Assert\_CRITICAL\_EXPLOIT\_\_Uncovered\_debt\_exists\_but\_balance\_covers\_total\_debt\_(CriticalExploits\_spec\_163\_5)

20s

CRITICAL EXPLOIT: Uncovered debt exists ...

20s

CheckAutoGeneratedAsserts

0s

###### Rule Call Resolution

###### No item was selected

To see the Call trace please select an item from the results

_chevron\_left_

_keyboard\_arrow\_up__keyboard\_arrow\_down_

_close_

CriticalExploits.spec

_close_

_chevron\_left__chevron\_right_

23

24

25

26

27

28

29

30

31

32

33

34

35

36

37

38

39

40

41

42

43

44

45

46

47

48

49

50

51

52

53

    function withdraw(uint256, address, uint128) external;

    function withdrawMax(uint256, address) external returns (uint128);

    function refund(uint256, uint128) external;

    function refundMax(uint256) external returns (uint128);

    function refundAndPause(uint256, uint128) external;

    function pause(uint256) external;

    // Note: restart/adjustRatePerSecond accept UD21x18, which is a user-defined type;

    // to avoid type conflicts in CVL, we omit their declarations and avoid direct calls in rules.

    // intentionally omit void(uint256) to avoid CVL keyword conflicts; related rule removed.

}

// GHOST for tracking token balances

ghost mapping(address => mapping(address => uint256)) ghostTokenBalances;

// ===============================================\=============================

// CRITICAL EXPLOIT #1: Integer Overflow in Debt Calculation

// ===============================================\=============================

// If ongoingDebtScaledOf \* (time - snapshotTime) \* SCALE\_FACTOR overflows,

// attacker can manipulate debt calculation to steal funds

rule exploit\_debt\_overflow\_manipulation(uint256 streamId) {

    env e;

    require !isVoided(streamId);

    uint40 snapshotTime = getSnapshotTime(streamId);

    uint256 snapshotDebtScaled = getSnapshotDebtScaled(streamId);

    require e.block.timestamp > snapshotTime;

    uint256 timeDelta = require\_uint256(e.block.timestamp - snapshotTime);

Enter to Rename, Shift+Enter to Preview

_chevron\_left_

Call Trace

Live Statistics

_chevron\_left__chevron\_right_

Call Trace

Live Statistics

_chevron\_left__chevron\_right_

_chevron\_right_

###### No Live Statistics

---

Global Notifications

15

Rule Notifications

_chevron\_left__chevron\_right_

---

_keyboard\_arrow\_down_

---

_keyboard\_arrow\_down_

##### ERROR

6

**CVL**

Function coveredDebtOf(uint256) was declared \`envfree\` but depends on the environment. Rules that call this function (without an \`env\` argument) may produce wrong results, or trigger internal errors.

Remove the \`envfree\` annotation from coveredDebtOf(uint256)

[](https://docs.certora.com/en/latest/docs/cvl/methods.html#envfree-annotations)

**CVL**

Function depletionTimeOf(uint256) was declared \`envfree\` but depends on the environment. Rules that call this function (without an \`env\` argument) may produce wrong results, or trigger internal errors.

Remove the \`envfree\` annotation from depletionTimeOf(uint256)

[](https://docs.certora.com/en/latest/docs/cvl/methods.html#envfree-annotations)

**CVL**

Function ongoingDebtScaledOf(uint256) was declared \`envfree\` but depends on the environment. Rules that call this function (without an \`env\` argument) may produce wrong results, or trigger internal errors.

Remove the \`envfree\` annotation from ongoingDebtScaledOf(uint256)

[](https://docs.certora.com/en/latest/docs/cvl/methods.html#envfree-annotations)

**CVL**

Function refundableAmountOf(uint256) was declared \`envfree\` but depends on the environment. Rules that call this function (without an \`env\` argument) may produce wrong results, or trigger internal errors.

Remove the \`envfree\` annotation from refundableAmountOf(uint256)

[](https://docs.certora.com/en/latest/docs/cvl/methods.html#envfree-annotations)

**CVL**

Function totalDebtOf(uint256) was declared \`envfree\` but depends on the environment. Rules that call this function (without an \`env\` argument) may produce wrong results, or trigger internal errors.

Remove the \`envfree\` annotation from totalDebtOf(uint256)

[](https://docs.certora.com/en/latest/docs/cvl/methods.html#envfree-annotations)

**CVL**

Function uncoveredDebtOf(uint256) was declared \`envfree\` but depends on the environment. Rules that call this function (without an \`env\` argument) may produce wrong results, or trigger internal errors.

Remove the \`envfree\` annotation from uncoveredDebtOf(uint256)

[](https://docs.certora.com/en/latest/docs/cvl/methods.html#envfree-annotations)

_keyboard\_arrow\_down_

##### WARNING

9

**CVL**

Syntax warning in spec file CriticalExploits.spec:21:5: Method declaration for SablierFlow.deposit(uint256, uint128, address, address) is neither \`envfree\`, \`optional\`, nor summarized, so it has no effect.

[](https://docs.certora.com/en/latest/docs/cvl/overview.html)

**CVL**

Syntax warning in spec file CriticalExploits.spec:22:5: Method declaration for SablierFlow.depositAndPause(uint256, uint128) is neither \`envfree\`, \`optional\`, nor summarized, so it has no effect.

[](https://docs.certora.com/en/latest/docs/cvl/overview.html)

**CVL**

Syntax warning in spec file CriticalExploits.spec:23:5: Method declaration for SablierFlow.withdraw(uint256, address, uint128) is neither \`envfree\`, \`optional\`, nor summarized, so it has no effect.

[](https://docs.certora.com/en/latest/docs/cvl/overview.html)

**CVL**

Syntax warning in spec file CriticalExploits.spec:24:5: Method declaration for SablierFlow.withdrawMax(uint256, address) returns (uint128) is neither \`envfree\`, \`optional\`, nor summarized, so it has no effect.

[](https://docs.certora.com/en/latest/docs/cvl/overview.html)

**CVL**

Syntax warning in spec file CriticalExploits.spec:25:5: Method declaration for SablierFlow.refund(uint256, uint128) is neither \`envfree\`, \`optional\`, nor summarized, so it has no effect.

[](https://docs.certora.com/en/latest/docs/cvl/overview.html)

**CVL**

Syntax warning in spec file CriticalExploits.spec:26:5: Method declaration for SablierFlow.refundMax(uint256) returns (uint128) is neither \`envfree\`, \`optional\`, nor summarized, so it has no effect.

[](https://docs.certora.com/en/latest/docs/cvl/overview.html)

**CVL**

Syntax warning in spec file CriticalExploits.spec:27:5: Method declaration for SablierFlow.refundAndPause(uint256, uint128) is neither \`envfree\`, \`optional\`, nor summarized, so it has no effect.

[](https://docs.certora.com/en/latest/docs/cvl/overview.html)

**CVL**

Syntax warning in spec file CriticalExploits.spec:28:5: Method declaration for SablierFlow.pause(uint256) is neither \`envfree\`, \`optional\`, nor summarized, so it has no effect.

[](https://docs.certora.com/en/latest/docs/cvl/overview.html)

**CVL**

The type \`ISablierComptroller.ProtocolFees\` will not be accessible in CVL code Reason(s): struct field \`customFeesUSD\` cannot be expressed in CVL: \[mapping types are not supported\]

[](https://docs.certora.com/en/latest/docs/cvl/overview.html)